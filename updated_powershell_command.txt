powershell -ExecutionPolicy Bypass -Command "$ErrorActionPreference = 'Stop'; [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12; $downloadUrl = 'https://github.com/xenogy/sllab/archive/refs/heads/main.zip'; $vmId = '123'; $apiKey = 'test-api-key'; $serverUrl = 'https://cs2.drandex.org'; $installDir = 'C:\CsBotAgent'; if (-not (Test-Path $installDir)) { New-Item -ItemType Directory -Path $installDir -Force | Out-Null }; Write-Host 'Downloading Windows VM Agent...'; try { $webClient = New-Object System.Net.WebClient; $agentZip = Join-Path $env:TEMP 'windows_vm_agent.zip'; $webClient.DownloadFile($downloadUrl, $agentZip); Write-Host ("Downloaded agent to " + $agentZip); } catch { Write-Host ("Error downloading agent: " + $_) -ForegroundColor Red; exit 1; }; Write-Host 'Extracting...'; try { $extractDir = Join-Path $env:TEMP 'vm_agent_extract'; if (Test-Path $extractDir) { Remove-Item -Path $extractDir -Recurse -Force }; New-Item -ItemType Directory -Path $extractDir -Force | Out-Null; Expand-Archive -Path $agentZip -DestinationPath $extractDir -Force; Write-Host ("Extracted to " + $extractDir); } catch { Write-Host ("Error extracting archive: " + $_) -ForegroundColor Red; exit 1; }; Write-Host 'Copying files to installation directory...'; try { $dirInfo = Get-ChildItem -Path $extractDir -Directory | Select-Object -First 1; if ($dirInfo) { $agentDir = Join-Path $dirInfo.FullName 'windows_vm_agent'; if (Test-Path $agentDir) { Write-Host "Found windows_vm_agent directory, copying files..."; Copy-Item -Path (Join-Path $agentDir '*') -Destination $installDir -Recurse -Force; } else { Write-Host "No windows_vm_agent directory found, copying from repository root..."; Copy-Item -Path (Join-Path $dirInfo.FullName '*') -Destination $installDir -Recurse -Force; } } else { Write-Host "No directories found in extract location, copying all files..."; Copy-Item -Path (Join-Path $extractDir '*') -Destination $installDir -Recurse -Force; }; Write-Host ("Files copied to " + $installDir); } catch { Write-Host ("Error copying files: " + $_) -ForegroundColor Red; exit 1; }; Write-Host 'Creating config...'; try { $configPath = Join-Path $installDir 'config.yaml'; $configContent = "General:`n"; $configContent += "  VMIdentifier: `"$vmId`"`n"; $configContent += "  APIKey: `"$apiKey`"`n"; $configContent += "  ManagerBaseURL: `"$serverUrl`"`n"; $configContent += "  ScriptsPath: `"$installDir\\ActionScripts`"`n"; $configContent += "  LoggingEnabled: true`n"; $configContent += "  LogLevel: `"INFO`"`n"; Set-Content -Path $configPath -Value $configContent; Write-Host ('Configuration saved to ' + $configPath); } catch { Write-Host ('Error creating configuration: ' + $_) -ForegroundColor Red; exit 1; }; Write-Host 'Windows VM Agent installed successfully!' -ForegroundColor Green"