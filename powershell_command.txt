powershell -ExecutionPolicy Bypass -Command "$ErrorActionPreference = 'Stop'; [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12; $downloadUrl = 'https://github.com/xenogy/sllab/archive/refs/heads/main.zip'; $vmId = '123'; $apiKey = 'test-api-key'; $serverUrl = 'https://cs2.drandex.org'; $installDir = 'C:\CsBotAgent'; if (-not (Test-Path $installDir)) { New-Item -ItemType Directory -Path $installDir -Force | Out-Null }; Write-Host 'Downloading Windows VM Agent...'; $webClient = New-Object System.Net.WebClient; $agentZip = Join-Path $env:TEMP 'windows_vm_agent.zip'; $webClient.DownloadFile($downloadUrl, $agentZip); Write-Host 'Extracting...'; $extractDir = Join-Path $env:TEMP 'vm_agent_extract'; if (Test-Path $extractDir) { Remove-Item -Path $extractDir -Recurse -Force }; New-Item -ItemType Directory -Path $extractDir -Force | Out-Null; Expand-Archive -Path $agentZip -DestinationPath $extractDir -Force; $dirInfo = Get-ChildItem -Path $extractDir -Directory | Select-Object -First 1; if ($dirInfo) { $agentDir = Join-Path $dirInfo.FullName 'windows_vm_agent'; if (Test-Path $agentDir) { Copy-Item -Path (Join-Path $agentDir '*') -Destination $installDir -Recurse -Force } else { Copy-Item -Path (Join-Path $dirInfo.FullName '*') -Destination $installDir -Recurse -Force } } else { Copy-Item -Path (Join-Path $extractDir '*') -Destination $installDir -Recurse -Force }; Write-Host 'Creating config...'; $configContent = 'General:\n  VMIdentifier: "0"\n  APIKey: "1"\n  ManagerBaseURL: "2"\n  ScriptsPath: "3\\ActionScripts"\n  LoggingEnabled: true\n  LogLevel: "INFO"'; $formattedConfig = $configContent -f $vmId, $apiKey, $serverUrl, $installDir; Set-Content -Path (Join-Path $installDir 'config.yaml') -Value $formattedConfig; Write-Host 'Windows VM Agent installed successfully!' -ForegroundColor Green"