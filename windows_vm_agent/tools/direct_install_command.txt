powershell -ExecutionPolicy Bypass -Command "Invoke-WebRequest -Uri 'http://your-server:8000/downloads/windows_vm_agent.zip' -OutFile '%TEMP%\windows_vm_agent.zip'; $installDir = 'C:\CsBotAgent'; New-Item -ItemType Directory -Path $installDir -Force | Out-Null; Expand-Archive -Path '%TEMP%\windows_vm_agent.zip' -DestinationPath '%TEMP%\vm_agent_extract' -Force; $extractDir = Get-ChildItem -Path '%TEMP%\vm_agent_extract' -Directory | Select-Object -First 1; if ($extractDir) { $agentDir = Join-Path $extractDir.FullName 'windows_vm_agent'; if (Test-Path $agentDir) { Copy-Item -Path \"$agentDir\*\" -Destination $installDir -Recurse -Force; } else { Copy-Item -Path \"$($extractDir.FullName)\*\" -Destination $installDir -Recurse -Force; } } else { Copy-Item -Path '%TEMP%\vm_agent_extract\*' -Destination $installDir -Recurse -Force; }; $configContent = 'General:`n  VMIdentifier: \"YOUR_VM_ID\"`n  APIKey: \"YOUR_API_KEY\"`n  ManagerBaseURL: \"http://your-server:8000\"`n  ScriptsPath: \"$installDir\ActionScripts\"`n  LoggingEnabled: true`n  LogLevel: \"INFO\"'; Set-Content -Path \"$installDir\config.yaml\" -Value $configContent; Write-Host 'Windows VM Agent installed successfully!'"
